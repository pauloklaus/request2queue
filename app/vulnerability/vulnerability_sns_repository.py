import json
from logging import Logger

from app.vulnerability.vulnerability_repository import VulnerabilityRepository
from infra.queue import Queue
from vulnerability.vulnerability import Vulnerability

class VulnerabilitySnsRepository(VulnerabilityRepository):
    def __init__(self, sns_handler: Queue, logger: Logger):
        self._sns_handler = sns_handler
        self._logger = logger

    def insert(self, vulnerability: Vulnerability):
        result = self._sns_handler.insert(json.dumps(vulnerability.to_json()))
        self._logger.info(f"[VulnerabilitySnsRepository] inserted to queue: {vulnerability}")
        return result
